<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Excel</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <form id="download-form">
        <div>
            <label for="start-date-1">Start date:</label>
            <input type="date" id="start-date-1" name="start-date-1">
        
            <label for="end-date-1">End date:</label>
            <input type="date" id="end-date-1" name="end-date-1">
        </div>
        <div>
            <label for="start-date-2">Start date:</label>
            <input type="date" id="start-date-2" name="start-date-2">
        
            <label for="end-date-2">End date:</label>
            <input type="date" id="end-date-2" name="end-date-2">
        </div>  
        <button type="submit">Download Excel</button>
    </form>

    <script>
        $("#download-form").on("submit", function(event) {
            event.preventDefault();
            const startDate1 = $("#start-date-1").val() || null;
            const endDate1 = $("#end-date-1").val() || null;
            const startDate2 = $("#start-date-2").val() || null;
            const endDate2 = $("#end-date-2").val() || null;

            $.ajax({
                url: "https://wtform.azurewebsites.net/api/FormDownloadf?code=jy9AvPLuhzew7nqbq0hx7hG5PJdFW8JPmQcG_kRrbt-NAzFulBxMMg==",
                type: "POST",
                data: JSON.stringify({
                    "start-date-1": startDate1,
                    "end-date-1": endDate1,
                    "start-date-2": startDate2,
                    "end-date-2": endDate2
                }),
                contentType: "application/json",
                success: function(response) {
                    const link = document.createElement("a");
                    link.href = response.file_url;
                    link.download = "data.xlsx";
                    link.click();
                }
            });
        });
    </script>
</body>
</html>