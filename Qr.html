<!DOCTYPE html>
<html>

<head>
	<title>Formulier</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: #5a5a5a;
			margin: 0;
			padding: 0;
		}

		h1 {
			text-align: center;
			margin-top: 50px;
			margin-bottom: 30px;
			color: rgb(255, 255, 255);
		}

		form {
			max-width: 500px;
			margin: 0 auto;
			background-color: #fff;
			padding: 30px;
			border-radius: 10px;
			box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
		}

		label {
			display: block;
			margin-bottom: 10px;
			color: #555;
		}

		input[type="text"],
		input[type="email"],
		input[type="tel"],
		input[type="month"] {
			width: 100%;
			padding: 10px;
			border: 1px solid #ddd;
			border-radius: 5px;
			box-sizing: border-box;
			margin-bottom: 20px;
			font-size: 16px;
			color: #333;
		}

		input[type="checkbox"] {
			display: inline-block;
			margin-right: 10px;
			float: left;
		}

		input[type="submit"] {
			background-color: #00e600;
			color: #fff;
			border: none;
			padding: 12px 20px;
			font-size: 16px;
			border-radius: 5px;
			cursor: pointer;
			transition: background-color 0.3s;
		}

		input[type="submit"]:hover {
			background-color: #008200;
		}

		input[type="checkbox"]:checked::before {
			content: "\2714";
			display: inline-block;
			font-size: 16px;
			width: 1;
			height: 13px;
			line-height: 1;
			text-align: center;
			background-color: #00e600;
			color: white;
			border-radius: 1;
			}

		.popup {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.5);
			display: none;
			align-items: center;
			justify-content: center;
		}

		.popup-content {
			background-color: #fff;
			padding: 20px;
			border-radius: 5px;
		}
		#logo {
			display: block;
			margin: 0 auto;
			padding: 30px;
			width: 35%; /* Set the width to 10% of the parent element */
  			height: auto; /* Automatically adjust the height to maintain aspect ratio */
		}	

	</style>



</head>

<body>
	<!-- <h1> <span style="color: rgb(63, 243, 46)">W</span>orking<span style="color: rgb(63, 243, 46)"> T</span>alent</h1> -->
	<img src="https://cmdrfop.github.io/Qr/WTWhite.png" id="logo" alt="Logo">
	<form id="upload-form" onsubmit="event.preventDefault(); asyncCall();">

		<label for="naam">Voornaam:</label>
		<input type="text" id="naam" name="naam" required>

		<label for="achternaam">Achternaam:</label>
		<input type="text" id="achternaam" name="achternaam" required>

		<label for="email">E-mailadres:</label>
		<input type="email" id="email" name="email" required>

		<label for="telefoon">06-nummer:</label>
		<input type="tel" id="telefoon" name="telefoon" required maxlength="10">

		<label for="studie">Studienaam:</label>
		<input type="text" id="studie" name="studie" required>

		<label for="afstudeerdatum">Verwachte afstudeerdatum:</label>
		<input type="month" placeholder="Maand Jaar" id="afstudeerdatum" name="afstudeerdatum" required>

		<label for="woonplaats">Woonplaats:</label>
		<input type="text" id="woonplaats" name="woonplaats" required>

		<label for="contactpersoon">Contactpersoon WT:</label>
		<input type="text" id="contactpersoon" name="contactpersoon" required>

		<div>

			<input type="checkbox" id="talentpool" name="talentpool" value=0 required>
			<label for="talentpool">Akkoord opslaan Talentpool - max 12 Maanden</label>


			<input type="checkbox" id="nieuwsbrief" name="nieuwsbrief" value=0>
			<label for="nieuwsbrief">Akkoord opslaan Nieuwsbrief - periodieke nieuwsbrief</label>


			<br><br>

		</div>
		<input type="submit" value="Verzenden" onclick="submitForm();">

		<!-- <div id="popup" class="popup">
            <div class="popup-content">
                <h2>Bedankt voor uw bericht!</h2>
                <p>We hebben uw gegevens ontvangen en zullen zo snel mogelijk contact met u opnemen.</p>
                <button onclick = "window.location.href='https://cmdrfop.github.io/Qr/FinishPage.html';">Sluiten</button>
            </div>
        </div> -->
		<div id="popup2" class="popup">
			<div class="popup-content">
				<h2>Gegevens Ontbreken</h2>
				<p>Vul alle gegevens in voordat U op verzenden drukt</p>
				<button onclick="document.getElementById('popup2').style.display='none'">Sluiten</button>
			</div>

		</div>

	</form>

	<script>

		const talentpoolCheckbox = document.getElementById("talentpool");
		const nieuwsbriefCheckbox = document.getElementById("nieuwsbrief");

		talentpoolCheckbox.addEventListener("change", function () {
			talentpoolCheckbox.value = this.checked ? "1" : "0";
		});

		nieuwsbriefCheckbox.addEventListener("change", function () {
			nieuwsbriefCheckbox.value = this.checked ? "1" : "0";
		});

		function submitForm() {

			const column1Value = document.getElementById("naam").value;
			const column2Value = document.getElementById("email").value;
			const column3Value = document.getElementById("telefoon").value;
			const column4Value = document.getElementById("studie").value;
			const column5Value = document.getElementById("afstudeerdatum").value;
			const column6Value = document.getElementById("woonplaats").value;
			const column7Value = document.getElementById("contactpersoon").value;
			const column8Value = document.getElementById("talentpool").value;
			const column9Value = document.getElementById("nieuwsbrief").value;


			const dataToInsert = {
				"column1": column1Value,
				"column2": column2Value,
				"column3": column3Value,
				"column4": column4Value,
				"column5": column5Value,
				"column6": column6Value,
				"column7": column7Value,
				"column8": column8Value,
				"column9": column9Value,
			};
			console.log(dataToInsert);

			var requiredFields = document.querySelectorAll('[required]');

			// Controleer of alle verplichte velden zijn ingevuld
			var allFieldsFilled = true;
			requiredFields.forEach(function (field) {
				if (field.value.trim() === '') {
					allFieldsFilled = false;
				}
			});

			// Als niet alle velden zijn ingevuld, toon dan een popup
			const talentpoolCheckbox = document.getElementById("talentpool");

			if (!allFieldsFilled || talentpoolCheckbox.value == 0) {
				var popup = document.getElementById("popup2");
				popup.style.display = "flex";
				return;
			}
			if (allFieldsFilled && talentpoolCheckbox.value == 1) {
				window.location.href = 'https://cmdrfop.github.io/Qr/FinishPage.html';
				//var popup = document.getElementById("popup");
				//popup.style.display = "flex";
			}



		}


		async function asyncCall() {
			submitForm();
			const column1Value = document.getElementById("naam").value;
			const column2Value = document.getElementById("email").value;
			const column3Value = document.getElementById("telefoon").value;
			const column4Value = document.getElementById("studie").value;
			const column5Value = document.getElementById("afstudeerdatum").value;
			const column6Value = document.getElementById("woonplaats").value;
			const column7Value = document.getElementById("contactpersoon").value;
			const column8Value = document.getElementById("talentpool").value;
			const column9Value = document.getElementById("nieuwsbrief").value;


			const dataToInsert = {
				"column1": column1Value,
				"column2": column2Value,
				"column3": column3Value,
				"column4": column4Value,
				"column5": column5Value,
				"column6": column6Value,
				"column7": column7Value,
				"column8": column8Value,
				"column9": column9Value,
			};
			console.log(dataToInsert);
			console.log('Fetching');
			try {

				const response = await fetch("https://wtform.azurewebsites.net/api/FormData?code=t4biSKxAnkb5-__vqSxVGQchu_lntq5kh42EXqSpJmWtAzFuHxwgGQ==", {
					method: "POST",
					headers: {
						"Content-Type": "application/json",
					},
					body: JSON.stringify(dataToInsert),
				});
				//console.log(response);
				console.log('Attempting upload');
				if (response.ok) {
					const jsonResponse = await response.json();
					//console.log(jsonResponse.message);
					console.log("Data successfully uploaded!");
				} else {
					throw new Error("Failed to upload data");
				}
			} catch (error) {
				console.error("Error: ", error);
				alert("An error occurred while uploading data. Please try again.");
			}

		}

	</script>

</body>

</html>